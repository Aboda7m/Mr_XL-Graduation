@page "/admin/balance-management"
@inject Mr_XL_Graduation.Services.UserService UserService
@inject NavigationManager NavigationManager

<h3>Balance Management</h3>

<div>
    <p>Below is the list of all students and their current balance. You can modify their balance as needed.</p>
</div>

<!-- Table to Display and Edit Balances -->
<table class="balance-table">
    <thead>
        <tr>
            <th>Student Name</th>
            <th>Student ID</th>
            <th>Balance</th>
            <th>Action</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var student in students)
        {
            <tr>
                <td>@student.FullName</td>
                <td>@student.StudentId</td>
                <td>
                    <input type="number" @bind="student.Balance" step="0.01" />
                </td>
                <td>
                    <button class="btn" @onclick="() => SaveBalance(student)">Save</button>
                </td>
            </tr>
        }
    </tbody>
</table>

<button class="btn" @onclick="GoBack">Back to Dashboard</button>

@code {
    private List<Student> students = new List<Student>();

    protected override void OnInitialized()
    {
        // Get all students and their balances
        students = UserService.GetAllStudents();
    }

    private void SaveBalance(Student student)
    {
        // Call the service to update the student's balance
        UserService.UpdateStudentBalance(student.StudentId, student.Balance);
    }

    private void GoBack()
    {
        NavigationManager.NavigateTo("/admin/dashboard");
    }
}
